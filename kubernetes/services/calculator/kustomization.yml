apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization

bases:
  - ../.template/api

images:
  - name: <Image>
    newName: jsoliveira/api-service-calculator
    newTag: latest-test

commonLabels:
  name: calculator

replacements:
- source:
    kind: Deployment
    fieldPath: metadata.labels.name
  targets:
  - select: 
      kind: Deployment
    fieldPaths:
      - metadata.name
      - spec.selector.matchLabels.app
      - spec.template.metadata.labels.app
      - spec.template.spec.containers.0.name
  - select: 
      kind: Service
    fieldPaths:
      - metadata.name
      - spec.selector.app